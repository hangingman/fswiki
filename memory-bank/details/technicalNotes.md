### インストール

#### サーバへの設置

Freestyle Wikiのインストールには、アーカイブを展開し、以下のフォルダ構造でサーバにアップロードします（docsディレクトリは不要）。wiki.cgiは実行可能パーミッションが必要です。

以下のディレクトリを作成し、CGIから書き込み可能なパーミッションを設定します。

*   `/attach` (添付ファイル)
*   `/pdf` (PDFファイル)
*   `/backup` (バックアップファイル)
*   `/data` (データファイル)
*   `/log` (ログファイル)
*   `/config` (設定ファイル)

dataディレクトリとconfigディレクトリ内のファイルも書き込み可能にする必要があります。

全体の構成例（パーミッションは一例）:

```
-+-/attach (添付ファイル) 707
 |
 +-/pdf (PDFファイル) 707
 |
 +-/tmpl (テンプレート)
 |
 +-/backup (バックアップファイル) 707
 |
 +-/data (データファイル) 707
 |  |
 |  +-*.wiki (デフォルトのデータファイル) 606
 |
 +-/log (ログファイル) 707
 |
 +-/config (設定ファイル) 707
 |  |
 |  +-*.dat (デフォルトの設定ファイル) 606
 |
 +-/theme (テーマ)
 |
 +-/plugin (プラグイン)
 |
 +-/lib (ライブラリ)
 |
 +-wiki.cgi (CGIスクリプト本体) 705
 |
 +-setup.dat (設定ファイル)
```

サーバ上でシェルが利用可能な場合、インストールディレクトリ直下のsetup.shを実行することで必要なディレクトリ作成やパーミッション設定を自動で行えます。

設定完了後、ブラウザからwiki.cgiを呼び出し、FrontPageが表示されれば設置成功です。

#### setup.datの設定

データ保管場所など、基本的な設定はsetup.datを編集して行います。

*   **メール通知機能:** ページ変更時の管理者へのメール通知を有効にするには、setup.datにsendmailのパスまたはSMTPサーバのホスト名を設定します。
*   **バックアップ世代数:** backupパラメータでバックアップ世代数を指定できます。0は無制限です。世代バックアップを行うと、差分メニューで過去の編集履歴と現在のソースの差分を閲覧できます。
*   **プロキシ設定:** rssやamazonプラグインなど、外部サーバにHTTP接続するプラグインを使用する場合、プロキシ設定（proxy_host, proxy_port, proxy_user, proxy_pass）が必要です。

#### セキュリティ

デフォルトのインストール方法では、setup.datや各種データディレクトリがHTTPで参照できてしまいます。セキュリティのため、.htaccessなどでアクセス制限を行うことが推奨されます。

```apache
<FilesMatch "\.(pm|dat|wiki|log)$">
  deny from ali
</FilesMatch>
```

データディレクトリはHTTPで見えない場所に配置することも可能で、その場合はsetup.datのディレクトリ指定を変更します。

#### バージョンアップ時の設置方法

設置ディレクトリ直下のsetup.dat、data、backup、pdf、log、configディレクトリ以外のファイルおよびディレクトリを削除し、配布ファイルで置き換えます。dataディレクトリ内のhelp.wikiも最新版で上書きします。setup.datは最新版で上書き後、設定内容を修正します。3.4.0以降では管理画面での設定項目追加がある場合があり、管理ユーザでログインして設定更新が必要です。

#### データのバックアップ方法

dataディレクトリ、attachディレクトリ、configディレクトリをコピーします。差分表示が必要ならbackupディレクトリ、PDFが必要ならpdfディレクトリもコピーします（PDFは必要に応じて再生成可能）。ログファイル（access.log, freeze.log, attach.log）も必要に応じてコピーします。

#### mod_perlで使用する場合

Ver3.4.1よりmod_perlに対応しています。wiki.cgiの先頭部分を編集し、chdirの引数にFSWikiのインストールディレクトリを指定してください。例えばFSWikiをC:/Apache/htdocs/fswikiに配置した場合は以下のようになります。

```perl
BEGIN {
  if(exists $ENV{MOD_PERL}){
    # カレントディレクトリの変更
    use Cwd;
    chdir("C:/Apache/htdocs/fswiki");
}
```

3.5.1以降はApache::Registory環境下でも完全に動作しますが、それ以前のバージョンでは一部機能に支障がある場合があります。Apache::PerlRun環境下であれば問題ありません。
