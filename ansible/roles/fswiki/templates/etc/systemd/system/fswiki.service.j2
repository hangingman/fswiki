[Unit]
Description=freestyle wiki application server
After=network.target

[Service]
Type=simple
WorkingDirectory=/opt/fswiki
PIDFile=/var/run/fswiki.pid

EnvironmentFile=/home/{{ exec_user }}/.perlbrew/init
ExecStart=/bin/bash -c '\
   source /home/{{ exec_user }}/.bashrc; \
   exec carton exec /opt/fswiki/local/bin/start_server \
   --pid-file=/var/run/fswiki/fswiki.pid --status-file=/opt/fswiki/fswiki.status -- starman --workers 4 app.psgi'

StandardOutput=file:/var/log/fswiki/fswiki.log
StandardError=file:/var/log/fswiki/fswiki.log

User={{ exec_user }}
Group={{ exec_user }}

[Install]
WantedBy=multi-user.target
